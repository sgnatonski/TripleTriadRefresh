var __extends=this.__extends||function(n,t){function i(){this.constructor=n}i.prototype=t.prototype,n.prototype=new i},GameView=function(n){function t(t,i){var r=this,f,u;n.call(this),this.viewName="game-view",this.gameId=null,this.game=ko.observable(new Game(null)),this.gameResult=ko.observable(new GameResult(null)),this.dragging=ko.observable(null),this.isReady=ko.observable(!1),this.isStarted=ko.observable(!1),this.expDone=ko.observable(!1),this.cardPtsDone=ko.observable(!1),this.closeResultHidden=ko.observable(!0),f=new Button("Leave game"),f.action=function(){return r.connection.leaveGame()},u=new Button("Set ready"),u.action=function(){return r.connection.declareReady()},u.hidden=ko.computed(function(){return r.game().getPlayer().isReady()}),this.menu().items([f,u]),this.gameId=t,this.connection.updateBoard=function(n){r.game(new Game(n))},this.connection.gameJoined=function(n){window.history.pushState(n,"Game",app.getPathAbs()+n),app.currentGameId(n),r.isLoading(!1)},this.connection.gameLeft=function(){window.history.pushState(null,"Game list",app.getPathAbs()),app.currentGameId(""),app.view(app.viewFac.createGamesView())},this.connection.receiveResult=function(n){r.gameResult(new GameResult(n)),r.closeResultHidden(r.gameResult().expGain()&&r.gameResult().cardPtsGain())},this.startConnection(function(){r.isLoading(!0),r.gameId?r.connection.joinGame(r.gameId):i?r.connection.createGameWithAi():r.connection.createGame()}),this.placeCard=function(n){r.connection.placeCard(r.dragging().id(),n),r.dragging(null)},this.resolveGame=function(){},this.closeResult=function(){r.closeResultHidden(!0),window.history.pushState(null,"Game list",app.getPathAbs()),app.currentGameId(""),app.view(app.viewFac.createGamesView())},this.cardPtsDone.subscribe(function(n){n&&r.closeResultHidden(!1)})}return __extends(t,n),t}(View)